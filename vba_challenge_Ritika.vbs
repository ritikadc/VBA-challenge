Sub ProjectRun()
' Project finished in collaboration w/ Brennan Bradley for the ASU Data Analytics Bootcamp
' Run script twice if first run doesn't finish all the way through    Dim ws As Worksheet    For Each ws In ThisWorkbook.Sheets    Dim ticker As String ' ticker    Dim ticker_row  As Integer  ' ticker_row    Dim ticker_total As Double  ' ticker_total    ticker_total = 0  ' Here's our shopping cart for tickers    ticker_row = 2 ' ticker retrieval and ticker count start in 2nd row of columns    LastRow = ws.Cells(Rows.Count, "A").End(xlUp).Row ' ensuring that i to LastRow goes all the way to end making the column range dynamic    LastRow2 = ws.Cells(Rows.Count, "L").End(xlUp).Row ' ensuring that L to LastRow goes all the way to end making the column range dynamic    LastRow3 = ws.Cells(Rows.Count, "K").End(xlUp).Row ' ensuring that K to LastRow goes all the way to end making the column range dynamic             ' Headers    ws.Cells(1, 9).Value = "Ticker"    ws.Cells(1, 10).Value = "Yearly Change"    ws.Cells(1, 11).Value = "Percent Change"    ws.Cells(1, 12).Value = "Total Stock Volume"    ws.Cells(2, 15).Value = "Greatest % Increase"    ws.Cells(3, 15).Value = "Greatest % Decrease"    ws.Cells(4, 15).Value = "Greatest Total Volume"    ws.Cells(1, 16).Value = "Ticker"    ws.Cells(1, 17).Value = "Value"            ' Columns formatter ( AutoFit to avoid string/integer overflow and column centering )    ws.Columns("A:Q").AutoFit    ws.Columns("A:Q").HorizontalAlignment = xlCenter    ws.Columns("K").NumberFormat = "0.00%"    Dim openPrice As Double    Dim closePrice As Double    openPrice = ws.Range("C2").Value    closePrice = ws.Range("F2").Value    Dim yearlyChange As Double    yearlyChange = 0    Dim percentChange As Double    percentChange = 0    Dim greatestPercentIncrease As Double    greatestPercentIncrease = 0#    Dim greatestPercentDecrease As Double    greatestPercentDecrease = 0#    Dim greatestTotalVolume As Double    Dim greatestTotalVolumeTicker As String    Dim greatestPercentIncreaseTicker As String    Dim greatestPercentDecreaseTicker As String            For i = 2 To LastRow            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then            ticker = ws.Cells(i, 1).Value            ticker_total = ticker_total + ws.Cells(i, 7).Value            ws.Range("I" & ticker_row).Value = ticker            ws.Range("L" & ticker_row).Value = ticker_total            yearlyChange = closePrice - openPrice            percentChange = yearlyChange / openPrice            ws.Cells(ticker_row, 10).Value = yearlyChange            ws.Cells(ticker_row, 11).Value = percentChange            openPrice = ws.Cells(i + 1, 3).Value            closePrice = ws.Cells(i + 1, 6).Value            ticker_row = ticker_row + 1            ticker_total = 0        Else            ticker_total = ticker_total + ws.Cells(i, 7).Value            closePrice = ws.Cells(i + 1, 6).Value        End If    Next i        greatestTotalVolume = ws.Cells(2, 12).Value    greatestTotalVolumeTicker = ws.Cells(2, 9).Value    For j = 2 To LastRow2    If ws.Cells(j, 12).Value >= greatestTotalVolume Then    greatestTotalVolume = ws.Cells(j, 12).Value    greatestTotalVolumeTicker = ws.Range("I" & j).Value    End If    Next j    ws.Cells(4, 17).Value = greatestTotalVolume    ws.Cells(4, 16).Value = greatestTotalVolumeTicker        greatestPercentIncrease = ws.Cells(2, 11).Value    greatestPercentIncreaseTicker = ws.Cells(2, 8).Value    For k = 2 To LastRow3    If ws.Cells(k, 11).Value >= greatestPercentIncrease Then    greatestPercentIncrease = ws.Cells(k, 11).Value    greatestPercentIncreaseTicker = ws.Range("I" & k).Value    Else    End If    Next k    ws.Cells(2, 17).Value = greatestPercentIncrease    ws.Cells(2, 16).Value = greatestPercentIncreaseTicker        greatestPercentDecrease = ws.Cells(2, 11).Value    greatestPercentDecreaseTicker = ws.Cells(2, 8).Value    For L = 2 To LastRow3    If ws.Cells(L, 11).Value < greatestPercentDecrease Then    greatestPercentDecrease = ws.Cells(L, 11).Value    greatestPercentDecreaseTicker = ws.Range("I" & L).Value    Else    End If    Next L    ws.Cells(3, 17).Value = greatestPercentDecrease    ws.Cells(3, 16).Value = greatestPercentDecreaseTicker        For M = 2 To LastRow3    If ws.Range("J" & M).Value >= 0 Then    ws.Range("J" & M).Interior.ColorIndex = 4    Else    ws.Range("J" & M).Interior.ColorIndex = 3    End If    Next M    Next wsEnd Sub